/**
 * Split Template Renderers for Frontend Slide Templates
 *
 * Two-column and multi-element layouts (S1-S4):
 * - S1: Visual + Text (chart/infographic/diagram on left, text on right)
 * - S2: Image + Content (full-height image on left, content on right)
 * - S3: Two Visuals (side by side charts/diagrams)
 * - S4: Comparison (two columns for compare/contrast)
 *
 * These are based on L02/L03/L27 structures but with proper slot tagging.
 * They do NOT replace the existing layouts - those continue to work for backend-generated content.
 */

// ===========================================
// S1-VISUAL-TEXT: Visual + Text Split
// ===========================================

/**
 * Visual + Text - S1-visual-text
 * 
 * Generated by v7.4 Template Builder
 */

/**
 * Visual + Text - S1-visual-text
 * 
 * Generated by v7.4 Template Builder
 */

function renderS1VisualText(content, slide = {}, slideIndex = 0) {
  // Extract background settings
  const backgroundColor = slide?.background_color || content?.background_color || '';
  const backgroundImage = slide?.background_image || content?.background_image || '';

  // Build background style
  let backgroundStyle = '';
  if (backgroundImage) {
    backgroundStyle = `background-image: url('${backgroundImage}'); background-size: cover; background-position: center; background-repeat: no-repeat;`;
    if (backgroundColor) {
      backgroundStyle += ` background-color: ${backgroundColor};`;
    }
  } else if (backgroundColor) {
    backgroundStyle = `background-color: ${backgroundColor};`;
  }

  return `
    <section data-layout="S1-visual-text" data-template="S1-visual-text" class="content-slide grid-container" style="${backgroundStyle}">
      <!-- Title -->
      <div class="title-slide"
           data-slot-type="title"
           data-section-id="slide-${slideIndex}-section-title"
           data-section-type="title"
           data-slide-index="${slideIndex}"
           data-editable="true"
           style="grid-row-start: 1; grid-row-end: 3; grid-column-start: 2; grid-column-end: 32; font-size: 48px; display: flex; flex-direction: column; align-items: flex-end; justify-content: flex-start; font-family: Poppins, sans-serif">
        ${content.slide_title || ''}
      </div>

      <!-- Subtitle -->
      <div class="subtitle-slide"
           data-slot-type="subtitle"
           data-section-id="slide-${slideIndex}-section-subtitle"
           data-section-type="subtitle"
           data-slide-index="${slideIndex}"
           data-editable="true"
           style="grid-row-start: 3; grid-row-end: 4; grid-column-start: 2; grid-column-end: 32; display: flex; flex-direction: column; align-items: center; justify-content: flex-start; font-size: 32px">
        ${content.subtitle || ''}
      </div>

      <!-- Right Content -->
      <div class="body-slide"
           data-slot-type="body"
           data-section-id="slide-${slideIndex}-section-body"
           data-section-type="body"
           data-slide-index="${slideIndex}"
           data-editable="true"
           style="grid-row-start: 4; grid-row-end: 18; grid-column-start: 20; grid-column-end: 32; text-align: left; padding: 25px 25px; font-size: 24px">
        ${content.rich_content || ''}
      </div>

      <!-- Footer -->
      ${(content.presentation_name || content.footer_text) ? `
      <div class="footer-slide"
           data-slot-type="footer"
           data-section-id="slide-${slideIndex}-section-footer"
           data-section-type="footer"
           data-slide-index="${slideIndex}"
           data-editable="true"
           style="grid-row-start: 18; grid-row-end: 19; grid-column-start: 2; grid-column-end: 7">
        ${content.presentation_name || content.footer_text || ''}
      </div>
      ` : ''}

      <!-- Logo -->
      ${content.company_logo ? `
      <div class="slide-logo"
           data-slot-type="logo"
           data-section-id="slide-${slideIndex}-section-logo"
           data-section-type="logo"
           data-slide-index="${slideIndex}"
           style="grid-row-start: 17; grid-row-end: 19; grid-column-start: 30; grid-column-end: 32; display: flex; align-items: center; justify-content: center;">
        <div style="max-width: 80%; max-height: 80%; display: flex; align-items: center; justify-content: center; font-size: 48px;">
          ${content.company_logo}
        </div>
      </div>
      ` : ''}

      <!-- Chart -->
      <div class="None-slide"
           data-slot-type="None"
           data-section-id="slide-${slideIndex}-section-None"
           data-section-type="None"
           data-slide-index="${slideIndex}"
           data-editable="true"
           style="grid-row-start: 4; grid-column-start: 2; grid-row-end: 18; grid-column-end: 20; font-size: 24px; display: flex; flex-direction: column; align-items: center; justify-content: center">
        ${content.None || ''}
      </div>
    </section>
  `;
}

// Export for browser
if (typeof window !== 'undefined') {
  window.renderS1VisualText = renderS1VisualText;
}

// Export for browser
if (typeof window !== 'undefined') {
  window.renderS1VisualText = renderS1VisualText;
}

// ===========================================
// S2-IMAGE-CONTENT: Image + Content Split
// ===========================================

/**
 * Image + Content - S2-image-content
 * 
 * Generated by v7.4 Template Builder
 */

function renderS2ImageContent(content, slide = {}, slideIndex = 0) {
  // Extract background settings
  const backgroundColor = slide?.background_color || content?.background_color || '';
  const backgroundImage = slide?.background_image || content?.background_image || '';

  // Build background style
  let backgroundStyle = '';
  if (backgroundImage) {
    backgroundStyle = `background-image: url('${backgroundImage}'); background-size: cover; background-position: center; background-repeat: no-repeat;`;
    if (backgroundColor) {
      backgroundStyle += ` background-color: ${backgroundColor};`;
    }
  } else if (backgroundColor) {
    backgroundStyle = `background-color: ${backgroundColor};`;
  }

  return `
    <section data-layout="S2-image-content" data-template="S2-image-content" class="content-slide grid-container" style="${backgroundStyle}">
      <!-- Image -->
      <div class="image-slide"
           data-slot-type="image"
           data-section-id="slide-${slideIndex}-section-image"
           data-section-type="image"
           data-slide-index="${slideIndex}"
           data-editable="true"
           style="grid-row-start: 1; grid-row-end: 19; grid-column-start: 1; grid-column-end: 12; display: flex; flex-direction: column; align-items: center; justify-content: center">
        ${content.image_url || ''}
      </div>

      <!-- Title -->
      <div class="title-slide"
           data-slot-type="title"
           data-section-id="slide-${slideIndex}-section-title"
           data-section-type="title"
           data-slide-index="${slideIndex}"
           data-editable="true"
           style="grid-row-start: 1; grid-row-end: 3; grid-column-start: 12; grid-column-end: 32; font-family: Poppins, sans-serif; font-size: 48px; display: flex; flex-direction: column; align-items: flex-end; justify-content: flex-start; padding: 0px 25px">
        ${content.slide_title || ''}
      </div>

      <!-- Subtitle -->
      <div class="subtitle-slide"
           data-slot-type="subtitle"
           data-section-id="slide-${slideIndex}-section-subtitle"
           data-section-type="subtitle"
           data-slide-index="${slideIndex}"
           data-editable="true"
           style="grid-row-start: 3; grid-row-end: 4; grid-column-start: 12; grid-column-end: 32; display: flex; flex-direction: column; align-items: center; justify-content: flex-start; font-size: 32px; padding: 0px 25px">
        ${content.subtitle || ''}
      </div>

      <!-- Content Area -->
      <div class="body-slide"
           data-slot-type="body"
           data-section-id="slide-${slideIndex}-section-body"
           data-section-type="body"
           data-slide-index="${slideIndex}"
           data-editable="true"
           style="grid-row-start: 4; grid-row-end: 18; grid-column-start: 12; grid-column-end: 32; padding: 25px 25px; text-align: left; font-size: 24px">
        ${content.rich_content || ''}
      </div>

      <!-- Footer -->
      ${(content.presentation_name || content.footer_text) ? `
      <div class="footer-slide"
           data-slot-type="footer"
           data-section-id="slide-${slideIndex}-section-footer"
           data-section-type="footer"
           data-slide-index="${slideIndex}"
           data-editable="true"
           style="grid-row-start: 18; grid-row-end: 19; grid-column-start: 12; grid-column-end: 17">
        ${content.presentation_name || content.footer_text || ''}
      </div>
      ` : ''}

      <!-- Logo -->
      ${content.company_logo ? `
      <div class="slide-logo"
           data-slot-type="logo"
           data-section-id="slide-${slideIndex}-section-logo"
           data-section-type="logo"
           data-slide-index="${slideIndex}"
           style="grid-row-start: 17; grid-row-end: 19; grid-column-start: 30; grid-column-end: 32; font-size: 20px; display: flex; align-items: center; justify-content: center;">
        <div style="max-width: 80%; max-height: 80%; display: flex; align-items: center; justify-content: center; font-size: 48px;">
          ${content.company_logo}
        </div>
      </div>
      ` : ''}
    </section>
  `;
}

// Export for browser
if (typeof window !== 'undefined') {
  window.renderS2ImageContent = renderS2ImageContent;
}

// ===========================================
// S3-TWO-VISUALS: Two Visuals Side by Side
// ===========================================

/**
 * Two Visuals - S3-two-visuals
 * 
 * Generated by v7.4 Template Builder
 */

/**
 * Two Visuals - S3-two-visuals
 * 
 * Generated by v7.4 Template Builder
 */

function renderS3TwoVisuals(content, slide = {}, slideIndex = 0) {
  // Extract background settings
  const backgroundColor = slide?.background_color || content?.background_color || '';
  const backgroundImage = slide?.background_image || content?.background_image || '';

  // Build background style
  let backgroundStyle = '';
  if (backgroundImage) {
    backgroundStyle = `background-image: url('${backgroundImage}'); background-size: cover; background-position: center; background-repeat: no-repeat;`;
    if (backgroundColor) {
      backgroundStyle += ` background-color: ${backgroundColor};`;
    }
  } else if (backgroundColor) {
    backgroundStyle = `background-color: ${backgroundColor};`;
  }

  return `
    <section data-layout="S3-two-visuals" data-template="S3-two-visuals" class="content-slide grid-container" style="${backgroundStyle}">
      <!-- Title -->
      <div class="title-slide"
           data-slot-type="title"
           data-section-id="slide-${slideIndex}-section-title"
           data-section-type="title"
           data-slide-index="${slideIndex}"
           data-editable="true"
           style="grid-row-start: 1; grid-row-end: 3; grid-column-start: 2; grid-column-end: 32; display: flex; flex-direction: column; align-items: center; justify-content: flex-start; font-size: 48px; font-family: Poppins, sans-serif">
        ${content.slide_title || ''}
      </div>

      <!-- Subtitle -->
      <div class="subtitle-slide"
           data-slot-type="subtitle"
           data-section-id="slide-${slideIndex}-section-subtitle"
           data-section-type="subtitle"
           data-slide-index="${slideIndex}"
           data-editable="true"
           style="grid-row-start: 3; grid-row-end: 4; grid-column-start: 2; grid-column-end: 32; font-size: 32px; font-family: Poppins, sans-serif; display: flex; flex-direction: column; align-items: center; justify-content: flex-start">
        ${content.subtitle || ''}
      </div>

      <!-- Left Caption -->
      <div class="body-slide"
           data-slot-type="body"
           data-section-id="slide-${slideIndex}-section-body"
           data-section-type="body"
           data-slide-index="${slideIndex}"
           data-editable="true"
           style="grid-row-start: 14; grid-row-end: 18; grid-column-start: 2; grid-column-end: 17; text-align: left; font-size: 24px; padding: 10px 10px">
        ${content.rich_content || ''}
      </div>

      <!-- Right Caption -->
      <div class="body-slide"
           data-slot-type="body"
           data-section-id="slide-${slideIndex}-section-body"
           data-section-type="body"
           data-slide-index="${slideIndex}"
           data-editable="true"
           style="grid-row-start: 14; grid-row-end: 18; grid-column-start: 17; grid-column-end: 32; font-size: 24px; text-align: left; padding: 10px 10px">
        ${content.rich_content || ''}
      </div>

      <!-- Footer -->
      ${(content.presentation_name || content.footer_text) ? `
      <div class="footer-slide"
           data-slot-type="footer"
           data-section-id="slide-${slideIndex}-section-footer"
           data-section-type="footer"
           data-slide-index="${slideIndex}"
           data-editable="true"
           style="grid-row-start: 18; grid-row-end: 19; grid-column-start: 2; grid-column-end: 7">
        ${content.presentation_name || content.footer_text || ''}
      </div>
      ` : ''}

      <!-- Logo -->
      ${content.company_logo ? `
      <div class="slide-logo"
           data-slot-type="logo"
           data-section-id="slide-${slideIndex}-section-logo"
           data-section-type="logo"
           data-slide-index="${slideIndex}"
           style="grid-row-start: 17; grid-row-end: 19; grid-column-start: 30; grid-column-end: 32; display: flex; align-items: center; justify-content: center;">
        <div style="max-width: 80%; max-height: 80%; display: flex; align-items: center; justify-content: center; font-size: 48px;">
          ${content.company_logo}
        </div>
      </div>
      ` : ''}

      <!-- Chart 1 -->
      <div class="None-slide"
           data-slot-type="None"
           data-section-id="slide-${slideIndex}-section-None"
           data-section-type="None"
           data-slide-index="${slideIndex}"
           data-editable="true"
           style="grid-row-start: 4; grid-column-start: 2; grid-row-end: 14; grid-column-end: 17; font-size: 24px; font-weight: normal; display: flex; flex-direction: column; align-items: center; justify-content: center">
        ${content.None || ''}
      </div>

      <!-- Chart 2 -->
      <div class="None-slide"
           data-slot-type="None"
           data-section-id="slide-${slideIndex}-section-None"
           data-section-type="None"
           data-slide-index="${slideIndex}"
           data-editable="true"
           style="grid-row-start: 4; grid-column-start: 17; grid-row-end: 14; grid-column-end: 32; font-size: 24px; display: flex; flex-direction: column; align-items: center; justify-content: center">
        ${content.None || ''}
      </div>
    </section>
  `;
}

// Export for browser
if (typeof window !== 'undefined') {
  window.renderS3TwoVisuals = renderS3TwoVisuals;
}

// Export for browser
if (typeof window !== 'undefined') {
  window.renderS3TwoVisuals = renderS3TwoVisuals;
}

// ===========================================
// S4-COMPARISON: Comparison Layout
// ===========================================

/**
 * Comparison - S4-comparison
 * 
 * Generated by v7.4 Template Builder
 */

function renderS4Comparison(content, slide = {}, slideIndex = 0) {
  // Extract background settings
  const backgroundColor = slide?.background_color || content?.background_color || '';
  const backgroundImage = slide?.background_image || content?.background_image || '';

  // Build background style
  let backgroundStyle = '';
  if (backgroundImage) {
    backgroundStyle = `background-image: url('${backgroundImage}'); background-size: cover; background-position: center; background-repeat: no-repeat;`;
    if (backgroundColor) {
      backgroundStyle += ` background-color: ${backgroundColor};`;
    }
  } else if (backgroundColor) {
    backgroundStyle = `background-color: ${backgroundColor};`;
  }

  return `
    <section data-layout="S4-comparison" data-template="S4-comparison" class="content-slide grid-container" style="${backgroundStyle}">
      <!-- Title -->
      <div class="title-slide"
           data-slot-type="title"
           data-section-id="slide-${slideIndex}-section-title"
           data-section-type="title"
           data-slide-index="${slideIndex}"
           data-editable="true"
           style="grid-row-start: 1; grid-row-end: 3; grid-column-start: 2; grid-column-end: 32; font-size: 48px; font-family: Poppins, sans-serif; display: flex; flex-direction: column; align-items: center; justify-content: flex-start">
        ${content.slide_title || ''}
      </div>

      <!-- Subtitle -->
      <div class="subtitle-slide"
           data-slot-type="subtitle"
           data-section-id="slide-${slideIndex}-section-subtitle"
           data-section-type="subtitle"
           data-slide-index="${slideIndex}"
           data-editable="true"
           style="grid-row-start: 3; grid-row-end: 4; grid-column-start: 2; grid-column-end: 32; display: flex; flex-direction: column; align-items: center; justify-content: flex-start; font-size: 32px">
        ${content.subtitle || ''}
      </div>

      <!-- Left Header -->
      <div class="header-slide"
           data-slot-type="header"
           data-section-id="slide-${slideIndex}-section-header"
           data-section-type="header"
           data-slide-index="${slideIndex}"
           data-editable="true"
           style="grid-row-start: 4; grid-row-end: 5; grid-column-start: 2; grid-column-end: 17; font-size: 24px; text-transform: uppercase">
        ${content.header_text || ''}
      </div>

      <!-- Right Header -->
      <div class="header-slide"
           data-slot-type="header"
           data-section-id="slide-${slideIndex}-section-header"
           data-section-type="header"
           data-slide-index="${slideIndex}"
           data-editable="true"
           style="grid-row-start: 4; grid-row-end: 5; grid-column-start: 17; grid-column-end: 32; font-size: 24px; text-transform: uppercase">
        ${content.header_text || ''}
      </div>

      <!-- Left Content -->
      <div class="body-slide"
           data-slot-type="body"
           data-section-id="slide-${slideIndex}-section-body"
           data-section-type="body"
           data-slide-index="${slideIndex}"
           data-editable="true"
           style="grid-row-start: 5; grid-row-end: 18; grid-column-start: 2; grid-column-end: 17; font-size: 24px; text-align: left">
        ${content.rich_content || ''}
      </div>

      <!-- Right Content -->
      <div class="body-slide"
           data-slot-type="body"
           data-section-id="slide-${slideIndex}-section-body"
           data-section-type="body"
           data-slide-index="${slideIndex}"
           data-editable="true"
           style="grid-row-start: 5; grid-row-end: 18; grid-column-start: 17; grid-column-end: 32; text-align: left; font-size: 24px">
        ${content.rich_content || ''}
      </div>

      <!-- Footer -->
      ${(content.presentation_name || content.footer_text) ? `
      <div class="footer-slide"
           data-slot-type="footer"
           data-section-id="slide-${slideIndex}-section-footer"
           data-section-type="footer"
           data-slide-index="${slideIndex}"
           data-editable="true"
           style="grid-row-start: 18; grid-row-end: 19; grid-column-start: 2; grid-column-end: 7">
        ${content.presentation_name || content.footer_text || ''}
      </div>
      ` : ''}

      <!-- Logo -->
      ${content.company_logo ? `
      <div class="slide-logo"
           data-slot-type="logo"
           data-section-id="slide-${slideIndex}-section-logo"
           data-section-type="logo"
           data-slide-index="${slideIndex}"
           style="grid-row-start: 17; grid-row-end: 19; grid-column-start: 30; grid-column-end: 32; font-size: 20px; display: flex; align-items: center; justify-content: center;">
        <div style="max-width: 80%; max-height: 80%; display: flex; align-items: center; justify-content: center; font-size: 48px;">
          ${content.company_logo}
        </div>
      </div>
      ` : ''}
    </section>
  `;
}

// Export for browser
if (typeof window !== 'undefined') {
  window.renderS4Comparison = renderS4Comparison;
}

// ===========================================
// B1-BLANK: Blank Canvas
// ===========================================

/**
 * Blank Canvas - B1-blank
 * 
 * Generated by v7.4 Template Builder
 */

function renderB1Blank(content, slide = {}, slideIndex = 0) {
  // Extract background settings
  const backgroundColor = slide?.background_color || content?.background_color || '';
  const backgroundImage = slide?.background_image || content?.background_image || '';

  // Build background style
  let backgroundStyle = '';
  if (backgroundImage) {
    backgroundStyle = `background-image: url('${backgroundImage}'); background-size: cover; background-position: center; background-repeat: no-repeat;`;
    if (backgroundColor) {
      backgroundStyle += ` background-color: ${backgroundColor};`;
    }
  } else if (backgroundColor) {
    backgroundStyle = `background-color: ${backgroundColor};`;
  }

  return `
    <section data-layout="B1-blank" data-template="B1-blank" class="content-slide grid-container" style="${backgroundStyle}">
      <!-- Title -->
      <div class="title-slide"
           data-slot-type="title"
           data-section-id="slide-${slideIndex}-section-title"
           data-section-type="title"
           data-slide-index="${slideIndex}"
           data-editable="true"
           style="grid-row-start: 1; grid-row-end: 3; grid-column-start: 2; grid-column-end: 32; font-family: Poppins, sans-serif; font-size: 48px; display: flex; flex-direction: column; align-items: center; justify-content: flex-start">
        ${content.slide_title || ''}
      </div>

      <!-- Subtitle -->
      <div class="subtitle-slide"
           data-slot-type="subtitle"
           data-section-id="slide-${slideIndex}-section-subtitle"
           data-section-type="subtitle"
           data-slide-index="${slideIndex}"
           data-editable="true"
           style="grid-row-start: 3; grid-row-end: 4; grid-column-start: 2; grid-column-end: 32; display: flex; flex-direction: column; align-items: center; justify-content: flex-start; font-size: 32px">
        ${content.subtitle || ''}
      </div>

      <!-- Canvas -->
      <div class="canvas-slide"
           data-slot-type="canvas"
           data-section-id="slide-${slideIndex}-section-canvas"
           data-section-type="canvas"
           data-slide-index="${slideIndex}"
           data-editable="true"
           style="grid-row-start: 4; grid-row-end: 18; grid-column-start: 2; grid-column-end: 32; font-size: 24px; display: flex; flex-direction: column; align-items: center; justify-content: center">
        ${content.canvas_content || ''}
      </div>

      <!-- Footer -->
      ${(content.presentation_name || content.footer_text) ? `
      <div class="footer-slide"
           data-slot-type="footer"
           data-section-id="slide-${slideIndex}-section-footer"
           data-section-type="footer"
           data-slide-index="${slideIndex}"
           data-editable="true"
           style="grid-row-start: 18; grid-row-end: 19; grid-column-start: 2; grid-column-end: 7">
        ${content.presentation_name || content.footer_text || ''}
      </div>
      ` : ''}

      <!-- Logo -->
      ${content.company_logo ? `
      <div class="slide-logo"
           data-slot-type="logo"
           data-section-id="slide-${slideIndex}-section-logo"
           data-section-type="logo"
           data-slide-index="${slideIndex}"
           style="grid-row-start: 17; grid-row-end: 19; grid-column-start: 30; grid-column-end: 32; font-size: 20px; display: flex; align-items: center; justify-content: center;">
        <div style="max-width: 80%; max-height: 80%; display: flex; align-items: center; justify-content: center; font-size: 48px;">
          ${content.company_logo}
        </div>
      </div>
      ` : ''}
    </section>
  `;
}

// Export for browser
if (typeof window !== 'undefined') {
  window.renderB1Blank = renderB1Blank;
}

// ===========================================
// EXPORTS
// ===========================================

// Export for browser
if (typeof window !== 'undefined') {
  window.renderS1VisualText = renderS1VisualText;
  window.renderS2ImageContent = renderS2ImageContent;
  window.renderS3TwoVisuals = renderS3TwoVisuals;
  window.renderS4Comparison = renderS4Comparison;
  window.renderB1Blank = renderB1Blank;
}

// Export for Node.js
if (typeof module !== 'undefined' && module.exports) {
  module.exports = {
    renderS1VisualText,
    renderS2ImageContent,
    renderS3TwoVisuals,
    renderS4Comparison,
    renderB1Blank
  };
}
