/**
 * 32×18 Grid System
 *
 * Enforces CSS Grid display on all slides with precise 32-column × 18-row layout.
 * Prevents V5's grid display failures.
 *
 * Grid Specifications:
 * - 32 columns (3.125% each = 100% / 32)
 * - 18 rows (5.556% each = 100% / 18)
 * - 1-indexed (grid lines numbered 1-33 for columns, 1-19 for rows)
 */

/* ===== Grid Display Enforcement ===== */
.reveal .slides section {
  display: grid !important;
  grid-template-columns: repeat(32, 1fr) !important;
  grid-template-rows: repeat(18, 1fr) !important;
  width: 100% !important;
  height: 100% !important;
  gap: 0 !important;
}

/* All child elements position via grid-area */
.reveal .slides section > * {
  /* grid-area will be set via JavaScript using GridEngine */
  /* Example: grid-area: 2 / 2 / 3 / 17; */
}

/* ===== Grid Overlay for Debugging ===== */
.grid-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  pointer-events: none;
  z-index: 9999;
  opacity: 0.3;
}

/* Column lines (32 vertical lines) */
.grid-overlay {
  background-image: repeating-linear-gradient(
    90deg,
    transparent,
    transparent calc((100vw / 32) - 1px),
    rgba(59, 130, 246, 0.4) calc(100vw / 32 - 1px),
    rgba(59, 130, 246, 0.4) calc(100vw / 32)
  );
}

/* Row lines (18 horizontal lines) */
.grid-overlay::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-image: repeating-linear-gradient(
    0deg,
    transparent,
    transparent calc((100vh / 18) - 1px),
    rgba(59, 130, 246, 0.4) calc(100vh / 18 - 1px),
    rgba(59, 130, 246, 0.4) calc(100vh / 18)
  );
}

/* Grid numbers for reference */
.grid-overlay::after {
  content: '32×18 Grid';
  position: absolute;
  top: 10px;
  left: 10px;
  background: rgba(59, 130, 246, 0.9);
  color: white;
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 12px;
  font-weight: 600;
  font-family: 'Inter', Arial, sans-serif;
  pointer-events: auto;
}

/* ===== Safe Zone Visualization (Optional) ===== */
.grid-overlay.show-safe-zone::after {
  content: '32×18 Grid | Safe Zone: 2-30, 2-17';
}

.grid-overlay.show-safe-zone {
  background-color: rgba(255, 0, 0, 0.05);
  background-image:
    /* Left unsafe zone (column 1) */
    linear-gradient(
      90deg,
      rgba(255, 0, 0, 0.1) 0%,
      rgba(255, 0, 0, 0.1) calc(100vw / 32),
      transparent calc(100vw / 32)
    ),
    /* Right unsafe zone (columns 31-32) */
    linear-gradient(
      90deg,
      transparent calc(100vw / 32 * 30),
      rgba(255, 0, 0, 0.1) calc(100vw / 32 * 30),
      rgba(255, 0, 0, 0.1) 100%
    ),
    /* Top unsafe zone (row 1) */
    linear-gradient(
      0deg,
      transparent calc(100vh / 18),
      rgba(255, 0, 0, 0.1) calc(100vh / 18),
      rgba(255, 0, 0, 0.1) 0%
    ),
    /* Column grid lines */
    repeating-linear-gradient(
      90deg,
      transparent,
      transparent calc((100vw / 32) - 1px),
      rgba(59, 130, 246, 0.4) calc(100vw / 32 - 1px),
      rgba(59, 130, 246, 0.4) calc(100vw / 32)
    );
}

/* ===== Border Highlight Mode ===== */
/* Show borders only on structural elements when 'B' is pressed */
body.show-borders .slide-title,
body.show-borders .subtitle,
body.show-borders .rich-content-area,
body.show-borders .footer-presentation-name,
body.show-borders .footer-company-logo {
  outline: 2px dotted #9ca3af !important;
  outline-offset: -2px;
}

/* Optional: Show element labels (comment out if too cluttered) */
body.show-borders .slide-title::after,
body.show-borders .subtitle::after,
body.show-borders .rich-content-area::after,
body.show-borders .footer-presentation-name::after,
body.show-borders .footer-company-logo::after {
  content: attr(class);
  position: absolute;
  top: 2px;
  left: 2px;
  background: rgba(156, 163, 175, 0.8);
  color: white;
  font-size: 10px;
  padding: 2px 4px;
  border-radius: 2px;
  pointer-events: none;
  font-family: 'Consolas', 'Monaco', monospace;
  z-index: 1000;
}

/* ===== Grid Helper Classes ===== */

/* Span full width (columns 1-32) */
.grid-full-width {
  grid-column: 1 / -1 !important;
}

/* Span content width (columns 2-30) */
.grid-content-width {
  grid-column: 2 / 31 !important;
}

/* Common row positions */
.grid-title-row {
  grid-row: 2 / 3 !important;
}

.grid-subtitle-row {
  grid-row: 3 / 4 !important;
}

.grid-footer-row {
  grid-row: 18 / 19 !important;
}

/* ===== Responsive Grid (Future Enhancement) ===== */
@media (max-width: 768px) {
  /* On mobile, we might want to adjust grid density */
  /* For now, keep 32×18 for consistency */
  .reveal .slides section {
    grid-template-columns: repeat(32, 1fr) !important;
    grid-template-rows: repeat(18, 1fr) !important;
  }
}

@media print {
  /* Hide grid overlay when printing */
  .grid-overlay {
    display: none !important;
  }
}

/* ===== Grid Cell Boundaries (for debugging) ===== */
.debug-grid-cells .reveal .slides section::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: 10000;
  background-image:
    repeating-linear-gradient(
      0deg,
      rgba(0, 255, 0, 0.2) 0px,
      rgba(0, 255, 0, 0.2) 1px,
      transparent 1px,
      transparent calc(100% / 18)
    ),
    repeating-linear-gradient(
      90deg,
      rgba(0, 255, 0, 0.2) 0px,
      rgba(0, 255, 0, 0.2) 1px,
      transparent 1px,
      transparent calc(100% / 32)
    );
}
